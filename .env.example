# Factory Agent Configuration
# ==============================================================================
# SECURITY: Secrets should be stored in Azure Key Vault, NOT in this file!
# See docs/AZURE_KEYVAULT_SETUP.md for setup instructions.
# ==============================================================================

# ==============================================================================
# AZURE KEY VAULT CONFIGURATION (RECOMMENDED - Production & Development)
# ==============================================================================
# When KEYVAULT_URL is set, all secrets are retrieved from Azure Key Vault.
# This is the RECOMMENDED approach for both production and development.
#
# Setup:
# 1. Create Key Vault: See docs/AZURE_KEYVAULT_SETUP.md
# 2. Upload secrets: ./scripts/upload_secrets_to_keyvault.sh <vault-name>
# 3. Set KEYVAULT_URL below
# 4. Login to Azure CLI: az login
#
# Authentication:
# - Local development: Uses Azure CLI credentials (az login)
# - Production: Uses Managed Identity (automatic in Azure Container Apps)
KEYVAULT_URL=https://your-vault-name.vault.azure.net/

# ==============================================================================
# STORAGE CONFIGURATION
# ==============================================================================
# Storage Mode: "local" (JSON file) or "azure" (Azure Blob Storage)
# Default is "azure" - requires KEYVAULT_URL or AZURE_STORAGE_CONNECTION_STRING
# Use "local" only for quick testing without Azure credentials
STORAGE_MODE=azure

# Azure Blob Container Name (when STORAGE_MODE=azure)
AZURE_BLOB_CONTAINER=factory-data

# Memory storage blob name (PR25 - uses same container as production data)
MEMORY_BLOB_NAME=memory.json

# Local data file path (when STORAGE_MODE=local)
DATA_FILE=./data/production.json

# ==============================================================================
# API SECURITY CONFIGURATION
# ==============================================================================
# Comma-separated list of allowed origins for CORS
# Development: localhost dev servers
# Production: Add your deployed frontend URL
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173

# Rate limiting - prevents abuse and excessive API costs
RATE_LIMIT_CHAT=10/minute
RATE_LIMIT_SETUP=5/minute
# Stricter rate limit for anonymous/demo access (cost protection)
# Use aggressive limits like "1/hour" or "3/day" to prevent abuse
RATE_LIMIT_SETUP_ANONYMOUS=1/hour

# ==============================================================================
# ENVIRONMENT CONFIGURATION
# ==============================================================================
# DEBUG=true: Detailed error messages (development only!)
# DEBUG=false: Generic error messages (recommended for production)
DEBUG=false
LOG_LEVEL=info

# ==============================================================================
# SECURITY CONFIGURATION (PR24D)
# ==============================================================================
# Prompt injection protection mode:
# - "log": Log suspicious patterns but allow request (default for demos)
# - "block": Reject requests with suspicious patterns (recommended for production)
PROMPT_INJECTION_MODE=log

# ==============================================================================
# OEE CONFIGURATION (PR24D)
# ==============================================================================
# OEE Performance Factor (simplified for demo)
# Valid range: 0.0 to 1.0 (e.g., 0.95 = 95% performance efficiency)
# Default: 0.95 (industry typical for well-maintained equipment)
# In production, this should be calculated from actual cycle times
OEE_PERFORMANCE_FACTOR=0.95

# ==============================================================================
# AZURE BLOB STORAGE RETRY & TIMEOUT (Optional tuning)
# ==============================================================================
# Retry behavior for transient network failures
# Formula: delay = initial_backoff + (increment_base ** (retry_count - 1))
# Example with defaults: 2s, 4s, 8s delays between attempts
AZURE_BLOB_RETRY_TOTAL=3
AZURE_BLOB_INITIAL_BACKOFF=2
AZURE_BLOB_INCREMENT_BASE=2

# Timeout settings (seconds)
AZURE_BLOB_CONNECTION_TIMEOUT=30
AZURE_BLOB_OPERATION_TIMEOUT=60

# ==============================================================================
# AZURE AD AUTHENTICATION (Optional - for admin operations)
# ==============================================================================
# Required for protected endpoints (e.g., POST /api/setup)
# Get from Azure Portal -> Azure Active Directory -> App registrations
AZURE_AD_TENANT_ID=your-tenant-id-here
AZURE_AD_CLIENT_ID=your-client-id-here

# ==============================================================================
# SECRETS (Only if NOT using Azure Key Vault)
# ==============================================================================
# WARNING: Only use these for quick local testing WITHOUT Key Vault.
# For any shared environment, use Azure Key Vault instead!
#
# If you set KEYVAULT_URL above, these values are IGNORED.
# The application will retrieve secrets from Key Vault instead.
#
# Key Vault secret names (hyphenated):
# - AZURE-ENDPOINT
# - AZURE-API-KEY
# - AZURE-STORAGE-CONNECTION-STRING
# - AZURE-DEPLOYMENT-NAME
# - AZURE-API-VERSION
# - FACTORY-NAME

# Azure AI Foundry Endpoint
# SECURITY: Store in Key Vault as "AZURE-ENDPOINT"
# Format: https://<resource>.services.ai.azure.com/ (Azure AI Foundry - recommended)
#         NOT https://<resource>.cognitiveservices.azure.com/ (legacy Azure OpenAI Service)
# AZURE_ENDPOINT=your-azure-endpoint-here

# Azure AI Foundry API Key
# SECURITY: Store in Key Vault as "AZURE-API-KEY"
# AZURE_API_KEY=your-azure-api-key-here

# Model Deployment Name (e.g., gpt-4, gpt-4o)
# SECURITY: Store in Key Vault as "AZURE-DEPLOYMENT-NAME"
# AZURE_DEPLOYMENT_NAME=gpt-4

# Azure API Version
# SECURITY: Store in Key Vault as "AZURE-API-VERSION"
# AZURE_API_VERSION=2024-08-01-preview

# Azure Storage Connection String
# SECURITY: Store in Key Vault as "AZURE-STORAGE-CONNECTION-STRING"
# AZURE_STORAGE_CONNECTION_STRING=

# Factory Name (display name)
# SECURITY: Store in Key Vault as "FACTORY-NAME"
# FACTORY_NAME=Demo Factory

# OpenAI API Key (only needed for voice interface feature)
# SECURITY: Store in Key Vault as "OPENAI-API-KEY" if using voice
# OPENAI_API_KEY=your-openai-api-key-here
